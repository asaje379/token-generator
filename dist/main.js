"use strict";var a=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var d=Object.prototype.hasOwnProperty;var l=(n,e)=>{for(var t in e)a(n,t,{get:e[t],enumerable:!0})},x=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of k(e))!d.call(n,r)&&r!==t&&a(n,r,{get:()=>e[r],enumerable:!(i=y(e,r))||i.enumerable});return n};var u=n=>x(a({},"__esModule",{value:!0}),n);var v={};l(v,{sign:()=>T,verify:()=>A});module.exports=u(v);var o=require("crypto"),s=class{constructor({algorithm:e="aes-256-cbc"}){this.key=Buffer.from((0,o.randomBytes)(32));this.iv=(0,o.randomBytes)(16);this.algorithm=e}encrypt(e){let t=(0,o.createCipheriv)(this.algorithm,this.key,this.iv),i=t.update(e);return i=Buffer.concat([i,t.final()]),`${i.toString("hex")}.${this.iv.toString("hex")}.${this.key.toString("hex")}`}decrypt(e){let[t,i,r]=e.split(".");if(!t||!i||!r)throw new Error("The token is not well formed");let f=Buffer.from(i,"hex"),p=Buffer.from(t,"hex"),m=Buffer.from(r,"hex"),h=(0,o.createDecipheriv)(this.algorithm,m,f),g=h.update(p);return g=Buffer.concat([g,h.final()]),g.toString()}};var c=class{static sign(e){let{data:t,key:i,expiresIn:r}=e,f={data:t,key:i,expiration:r?r+Date.now():void 0};return new s({algorithm:e.algorithm}).encrypt(JSON.stringify(f))}static verify(e){let{key:t,token:i}=e,r=JSON.parse(new s({algorithm:e.algorithm}).decrypt(i));if(r.key!==t)throw new Error("The key you provided is not valid");if(r.expiration<Date.now())throw new Error("Token expired");return r.data}};var T=c.sign,A=c.verify;0&&(module.exports={sign,verify});
